<html lang="en"></html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudFraction AI - Shared Cloud Computation</title>
    <script src="https://unpkg.com/react/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00ff9d;
            --cyber-purple: #b967ff;
            --dark-void: #0a0b0e;
            --matrix-green: #00ff41;
        }
        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--dark-void);
            color: #e0e0e0;
        }
        .ascii-border {
            position: relative;
        }
        .ascii-border::before {
            content: "+--------------------+";
            position: absolute;
            top: -20px;
            left: 0;
            color: var(--neon-blue);
            opacity: 0.5;
        }
        .ascii-border::after {
            content: "+--------------------+";
            position: absolute;
            bottom: -20px;
            left: 0;
            color: var(--neon-blue);
            opacity: 0.5;
        }
        .matrix-bg {
            background: linear-gradient(180deg, rgba(0,255,65,0.05) 0%, rgba(0,255,65,0) 100%);
        }
    </style>
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://unpkg.com/@solana/wallet-adapter-base"></script>
    <script src="https://unpkg.com/@solana/wallet-adapter-phantom"></script>
</head>
<body class="bg-gradient-to-br from-gray-900 to-black text-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        function App() {
            const [showNotifications, setShowNotifications] = React.useState(false);
            const [showUserMenu, setShowUserMenu] = React.useState(false);
            const [activeTab, setActiveTab] = React.useState('dashboard');

            const [processes, setProcesses] = React.useState([
                {
                    id: 'P1024',
                    name: 'BERT_TRAIN_01',
                    type: 'ML_TRAINING',
                    units: 128,
                    bidPrice: 0.45,
                    status: 'RUNNING',
                    progress: 45,
                    timeRemaining: '2:14:33'
                },
                {
                    id: 'P1025',
                    name: 'GPT_FINETUNE_03',
                    type: 'ML_TRAINING',
                    units: 256,
                    bidPrice: 0.38,
                    status: 'QUEUED',
                    progress: 0,
                    timeRemaining: '4:00:00'
                }
            ]);

            const [showBidModal, setShowBidModal] = React.useState(false);
            const [newBid, setNewBid] = React.useState({
                name: '',
                units: 64,
                bidPrice: 0.40,
                duration: 2
            });

            const [walletConnected, setWalletConnected] = React.useState(false);
            const [byteBalance, setByteBalance] = React.useState(1000.00);
            const [bytePrice, setBytePrice] = React.useState(0.42); // Current $BYTE price in USD

            const connectWallet = async () => {
                try {
                    const { PhantomWalletAdapter } = window.SolanaWalletAdapter;
                    const wallet = new PhantomWalletAdapter();
                    await wallet.connect();
                    
                    setWalletConnected(true);
                    // Get $BYTE balance
                    const response = await fetch(`/api/token/balance/${wallet.publicKey.toString()}`);
                    const { balance } = await response.json();
                    setByteBalance(balance);
                } catch (error) {
                    console.error('Error connecting wallet:', error);
                    alert('Failed to connect wallet');
                }
            };

            const submitBid = async () => {
                try {
                    const response = await fetch('/api/compute/bid', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            walletAddress: wallet.publicKey.toString(),
                            processName: newBid.name,
                            units: newBid.units,
                            bidPrice: newBid.bidPrice,
                            duration: newBid.duration
                        })
                    });
                    
                    const { success, transaction } = await response.json();
                    if (success) {
                        // Sign and send transaction
                        const signedTx = await wallet.signTransaction(transaction);
                        const signature = await connection.sendRawTransaction(signedTx.serialize());
                        await connection.confirmTransaction(signature);
                        
                        setProcesses([...processes, {
                            id: `P${1026 + processes.length}`,
                            name: newBid.name,
                            type: 'ML_TRAINING',
                            units: newBid.units,
                            bidPrice: newBid.bidPrice,
                            status: 'QUEUED',
                            progress: 0,
                            timeRemaining: `${newBid.duration}:00:00`
                        }]);
                        setShowBidModal(false);
                    }
                } catch (error) {
                    console.error('Error submitting bid:', error);
                    alert('Failed to submit bid');
                }
            };

            return (
                <div className="min-h-screen flex flex-col">
                    <header className="bg-black/80 backdrop-blur-md border-b border-green-500/20 sticky top-0 z-50">
                        <nav className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex justify-between h-16">
                                <div className="flex">
                                    <div className="flex-shrink-0 flex items-center">
                                        <div className="flex items-center space-x-2">
                                            <div className="font-mono text-2xl font-bold">
                                                <span className="text-green-400">[</span>
                                                <span className="text-purple-400">BYTE</span>
                                                <span className="text-green-400">]</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="hidden sm:ml-6 sm:flex sm:space-x-8">
                                        {['Terminal', 'Network', 'Docs', 'Stats'].map(item => (
                                            <a
                                                key={item}
                                                href="#"
                                                className={`${
                                                    activeTab === item.toLowerCase() 
                                                    ? 'border-green-400 text-green-400' 
                                                    : 'border-transparent text-gray-400 hover:text-green-400'
                                                } inline-flex items-center px-1 pt-1 border-b text-sm font-mono transition-colors duration-200`}
                                                onClick={() => setActiveTab(item.toLowerCase())}
                                            >
                                                <span className="text-green-400 mr-1">&gt;</span>
                                                {item}
                                            </a>
                                        ))}
                                    </div>
                                </div>

                                <div className="hidden sm:ml-6 sm:flex sm:items-center space-x-4">
                                    <div className="relative">
                                        <button 
                                            className="bg-gray-900 p-2 rounded text-green-400 hover:text-green-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200 border border-green-400/30"
                                            onClick={() => setShowNotifications(!showNotifications)}
                                        >
                                            <span className="sr-only">View notifications</span>
                                            <div className="relative">
                                                <i className="fas fa-terminal"></i>
                                                <span className="absolute -top-1 -right-1 bg-purple-500 rounded-full w-2 h-2"></span>
                                            </div>
                                        </button>
                                        
                                        {showNotifications && (
                                            <div className="absolute right-0 mt-2 w-96 bg-gray-900 rounded border border-green-400/30 shadow-lg shadow-green-400/10">
                                                <div className="p-4 border-b border-green-400/30">
                                                    <pre className="text-xs text-green-400">
                                                        +--- SYSTEM NOTIFICATIONS ---+
                                                    </pre>
                                                </div>
                                                <div className="p-4 hover:bg-gray-800 cursor-pointer">
                                                    <p className="text-sm font-mono text-green-400">&gt; New compute units allocated</p>
                                                    <p className="text-xs text-gray-400 mt-1">timestamp: 2024-03-21 14:23:01</p>
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    <button 
                                        className="bg-green-400 px-4 py-2 rounded text-black hover:bg-green-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200 font-mono"
                                    >
                                        <i className="fas fa-plus-square mr-2"></i>
                                        NEW_PROCESS
                                    </button>
                                </div>
                            </div>
                        </nav>
                    </header>

                    <main className="flex-grow matrix-bg">
                        <div className="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
                            {/* Resource Monitor Section */}
                            <div className="mb-8">
                                <pre className="text-green-400 mb-4">
                                    +--- SYSTEM RESOURCES ---+
                                </pre>
                                <div className="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4">
                                    {/* Compute Unit Card */}
                                    <div className="bg-gray-900 rounded border border-green-400/30 p-6 hover:shadow-lg hover:shadow-green-400/10 transition-all duration-200">
                                        <div className="flex items-center justify-between mb-4">
                                            <div className="bg-green-400/10 p-3 rounded">
                                                <i className="fas fa-microchip text-green-400 text-xl"></i>
                                            </div>
                                            <pre className="text-xs text-purple-400">ONLINE</pre>
                                        </div>
                                        <h3 className="text-gray-400 text-sm font-mono">COMPUTE_UNITS</h3>
                                        <div className="flex items-baseline">
                                            <p className="text-2xl font-bold text-green-400">1,024</p>
                                            <p className="text-purple-400 text-sm ml-2">active</p>
                                        </div>
                                        <div className="mt-4">
                                            <div className="w-full bg-gray-800 rounded h-2">
                                                <div className="bg-green-400 h-2 rounded" style={{width: "70%"}}></div>
                                            </div>
                                            <p className="text-xs text-gray-400 mt-1 font-mono">UTIL: 70%</p>
                                        </div>
                                    </div>

                                    {/* Add similar cards for Memory, Network, Storage */}
                                </div>
                            </div>

                            {/* Active Processes Section */}
                            <div className="bg-gray-900 rounded border border-green-400/30 p-6 mb-8">
                                <div className="flex items-center justify-between mb-6">
                                    <pre className="text-green-400">
                                        +--- ACTIVE PROCESSES ---+
                                    </pre>
                                    <div className="flex space-x-2">
                                        <button className="px-3 py-1 border border-green-400/30 rounded text-sm font-mono text-green-400 hover:bg-green-400/10">
                                            <i className="fas fa-filter mr-2"></i>
                                            FILTER
                                        </button>
                                    </div>
                                </div>

                                {/* Process table with monospace font and terminal-like styling */}
                            </div>

                            {/* System Analytics Section */}
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                                <div className="bg-gray-900 rounded border border-green-400/30 p-6">
                                    <pre className="text-green-400 mb-4">
                                        +--- RESOURCE METRICS ---+
                                    </pre>
                                    {/* Add terminal-style metrics visualization */}
                                </div>
                                <div className="bg-gray-900 rounded border border-green-400/30 p-6">
                                    <pre className="text-green-400 mb-4">
                                        +--- NETWORK STATUS ---+
                                    </pre>
                                    {/* Add network status visualization */}
                                </div>
                            </div>

                            {/* Process Queue Manager */}
                            <div className="bg-gray-900 rounded border border-green-400/30 p-6 mb-8">
                                <div className="flex items-center justify-between mb-6">
                                    <pre className="text-green-400">
                                        +--- PROCESS QUEUE MANAGER ---+
                                    </pre>
                                    <button 
                                        onClick={() => setShowBidModal(true)}
                                        className="px-4 py-2 bg-green-400/10 border border-green-400/30 rounded text-sm font-mono text-green-400 hover:bg-green-400/20"
                                    >
                                        <i className="fas fa-plus-square mr-2"></i>
                                        NEW_BID
                                    </button>
                                </div>

                                <div className="overflow-x-auto">
                                    <table className="min-w-full divide-y divide-green-400/30">
                                        <thead>
                                            <tr className="text-left text-xs text-gray-400">
                                                <th className="px-4 py-2">PROCESS_ID</th>
                                                <th className="px-4 py-2">NAME</th>
                                                <th className="px-4 py-2">UNITS</th>
                                                <th className="px-4 py-2">BID_PRICE</th>
                                                <th className="px-4 py-2">STATUS</th>
                                                <th className="px-4 py-2">PROGRESS</th>
                                                <th className="px-4 py-2">TIME_REMAINING</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-green-400/30">
                                            {processes.map(process => (
                                                <tr key={process.id} className="text-sm">
                                                    <td className="px-4 py-3 text-purple-400">{process.id}</td>
                                                    <td className="px-4 py-3 text-green-400">{process.name}</td>
                                                    <td className="px-4 py-3 text-gray-400">{process.units}</td>
                                                    <td className="px-4 py-3 text-gray-400">${process.bidPrice}/unit</td>
                                                    <td className="px-4 py-3">
                                                        <span className={`px-2 py-1 rounded text-xs ${
                                                            process.status === 'RUNNING' 
                                                                ? 'bg-green-400/20 text-green-400' 
                                                                : 'bg-purple-400/20 text-purple-400'
                                                        }`}>
                                                            {process.status}
                                                        </span>
                                                    </td>
                                                    <td className="px-4 py-3">
                                                        <div className="w-32 bg-gray-800 rounded h-2">
                                                            <div 
                                                                className="bg-green-400 h-2 rounded" 
                                                                style={{width: `${process.progress}%`}}
                                                            ></div>
                                                        </div>
                                                    </td>
                                                    <td className="px-4 py-3 text-gray-400">{process.timeRemaining}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            {/* Bid Modal */}
                            {showBidModal && (
                                <div className="fixed inset-0 bg-black/50 flex items-center justify-center">
                                    <div className="bg-gray-900 rounded-lg border border-green-400/30 p-6 w-full max-w-md">
                                        <pre className="text-green-400 mb-4">
                                            +--- NEW PROCESS BID ---+
                                        </pre>
                                        <form className="space-y-4">
                                            <div>
                                                <label className="block text-gray-400 text-sm mb-1">PROCESS_NAME</label>
                                                <input 
                                                    type="text"
                                                    className="w-full bg-gray-800 border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400"
                                                    value={newBid.name}
                                                    onChange={e => setNewBid({...newBid, name: e.target.value})}
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-gray-400 text-sm mb-1">COMPUTE_UNITS</label>
                                                <input 
                                                    type="number"
                                                    className="w-full bg-gray-800 border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400"
                                                    value={newBid.units}
                                                    onChange={e => setNewBid({...newBid, units: parseInt(e.target.value)})}
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-gray-400 text-sm mb-1">BID_PRICE ($/unit)</label>
                                                <input 
                                                    type="number"
                                                    step="0.01"
                                                    className="w-full bg-gray-800 border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400"
                                                    value={newBid.bidPrice}
                                                    onChange={e => setNewBid({...newBid, bidPrice: parseFloat(e.target.value)})}
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-gray-400 text-sm mb-1">DURATION (hours)</label>
                                                <input 
                                                    type="number"
                                                    className="w-full bg-gray-800 border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400"
                                                    value={newBid.duration}
                                                    onChange={e => setNewBid({...newBid, duration: parseInt(e.target.value)})}
                                                />
                                            </div>
                                            <div className="flex space-x-3">
                                                <button 
                                                    type="button"
                                                    className="flex-1 bg-green-400 text-black px-4 py-2 rounded hover:bg-green-300"
                                                    onClick={() => {
                                                        setProcesses([...processes, {
                                                            id: `P${1026 + processes.length}`,
                                                            name: newBid.name,
                                                            type: 'ML_TRAINING',
                                                            units: newBid.units,
                                                            bidPrice: newBid.bidPrice,
                                                            status: 'QUEUED',
                                                            progress: 0,
                                                            timeRemaining: `${newBid.duration}:00:00`
                                                        }]);
                                                        setShowBidModal(false);
                                                    }}
                                                >
                                                    SUBMIT_BID
                                                </button>
                                                <button 
                                                    type="button"
                                                    className="flex-1 border border-green-400/30 text-green-400 px-4 py-2 rounded hover:bg-green-400/10"
                                                    onClick={() => setShowBidModal(false)}
                                                >
                                                    CANCEL
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            )}
                        </div>
                    </main>

                    <footer className="bg-gray-900 border-t border-green-400/20">
                        <div className="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
                            <pre className="text-center text-green-400/60 text-xs">
                                [BYTE] v1.0.0 | UPTIME: 324:12:31 | STATUS: OPERATIONAL
                            </pre>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>